<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>Î¤Î¿ Î¤Î±Î¼ÎµÎ¯Î¿ Ï„Î¿Ï… Î£Ï‡Î¿Î»ÎµÎ¯Î¿Ï… - Papanikolaou Georgios</title>
    <style>
        body { font-family: 'Comic Sans MS', cursive; background-color: #f0f4f8; margin: 0; padding: 10px; }
        .container { max-width: 1250px; margin: auto; background: white; border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 4px solid #3498db; position: relative; min-height: 920px; display: flex; flex-direction: column; }
        
        .footer-info { margin-top: auto; padding: 15px; border-top: 2px solid #eee; display: flex; justify-content: space-between; font-size: 14px; color: #7f8c8d; }
        .creator-info { font-weight: bold; color: #2980b9; }

        .level-menu { margin-bottom: 15px; display: flex; justify-content: center; gap: 10px; }
        .lvl-btn { padding: 12px 20px; border: 2px solid #3498db; border-radius: 12px; background: white; cursor: pointer; font-weight: bold; font-family: 'Comic Sans MS'; transition: 0.3s; }
        .lvl-btn.active { background: #3498db; color: white; }

        .game-layout { display: flex; gap: 20px; align-items: flex-start; flex-grow: 1; }

        .left-panel { flex: 0 0 420px; display: flex; flex-direction: column; align-items: center; background: #fff3e0; border-radius: 20px; padding: 20px; border: 3px solid #e67e22; }
        .cashier-img { width: 100%; height: auto; border-radius: 15px; margin-bottom: 15px; }
        #msg { width: 90%; font-size: 24px; font-weight: bold; text-align: center; padding: 15px; border-radius: 15px; background: white; border: 2px dashed #e67e22; min-height: 100px; display: flex; align-items: center; justify-content: center; }

        .right-panel { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        .info-card { background: #e1f5fe; padding: 20px; border-radius: 20px; border: 2px solid #3498db; text-align: center; position: relative;}
        .product-display { font-size: 85px; margin: 5px 0; }
        .display-screen { background: #2c3e50; color: #2ecc71; font-family: monospace; font-size: 55px; padding: 10px 20px; border-radius: 10px; border: 4px solid #95a5a6; display: inline-block; margin-bottom: 10px; }

        .banknotes-received { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .note-received { width: 150px; border: 5px solid transparent; border-radius: 8px; opacity: 0.1; transition: 0.3s; }
        .note-received.active-note { opacity: 1; border-color: red; box-shadow: 0 0 20px red; }

        .drawer { background: #ff9800; padding: 25px; border-radius: 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; border: 5px solid #e64a19; }
        
        .coin-item { position: relative; cursor: pointer; background: white; width: 95px; height: 95px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .bill-item { position: relative; cursor: pointer; background: white; width: 165px; height: 85px; border-radius: 10px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        .coin-item img { width: 85%; height: 85%; object-fit: contain; }
        .bill-item img { width: 90%; height: 90%; object-fit: contain; }

        .selection-ring { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 6px solid red; border-radius: inherit; box-sizing: border-box; display: none; pointer-events: none; }
        .selected .selection-ring { display: block; }

        .green-btn { width: 100px; height: 100px; background: #27ae60; border: none; border-radius: 50%; border-bottom: 6px solid #1e8449; color: white; font-size: 26px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .exit-btn { position: absolute; top: 15px; right: 15px; background: #e74c3c; color: white; border: none; border-radius: 8px; padding: 10px 15px; cursor: pointer; font-weight: bold; font-family: 'Comic Sans MS'; }

        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 20px; text-align: center; padding: 30px; box-sizing: border-box; }
        .name-input { padding: 15px; font-size: 26px; border-radius: 12px; border: 3px solid #3498db; margin: 20px 0; text-align: center; font-family: 'Comic Sans MS'; width: 350px; }
        .gender-box { display: flex; gap: 20px; margin-bottom: 20px; }
        .director-img { width: 200px; height: auto; margin-bottom: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div id="startScreen" class="overlay">
        <h1 style="color:#2980b9; font-size: 40px;">ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸ÎµÏ‚ ÏƒÏ„Î¿ Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î¤Î±Î¼ÎµÎ¯Î¿!</h1>
        <p style="font-size: 22px;">Î•Ï€Î¹Î»Î¿Î³Î®: Î‘Î³ÏŒÏÎ¹ Î® ÎšÎ¿ÏÎ¯Ï„ÏƒÎ¹;</p>
        
        <div class="gender-box">
            <button id="boyBtn" class="lvl-btn" style="font-size: 22px;" onclick="setGender('m')">ğŸ‘¦ Î‘Î³ÏŒÏÎ¹</button>
            <button id="girlBtn" class="lvl-btn" style="font-size: 22px;" onclick="setGender('f')">ğŸ‘§ ÎšÎ¿ÏÎ¯Ï„ÏƒÎ¹</button>
        </div>

        <input type="text" id="studentName" class="name-input" placeholder="Î“ÏÎ¬ÏˆÎµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î¬ ÏƒÎ¿Ï…...">
        <button id="finalStartBtn" class="lvl-btn" style="font-size:30px; padding: 20px 50px; background: #27ae60; color: white; border:none; display:none;" onclick="initGame()">Î•ÎÎ‘Î¡ÎÎ—</button>
    </div>

    <div id="endScreen" class="overlay" style="display:none;">
        <img src="giorgos.png" class="director-img" onerror="this.src='https://via.placeholder.com/200?text=Director'">
        <h1 style="color:#27ae60; font-size: 36px;">ÎœÏ€ÏÎ¬Î²Î¿!</h1>
        <p id="byeMsg" style="font-size: 26px; font-weight: bold; color: #2c3e50;"></p>
        <button class="lvl-btn" style="font-size:25px; padding: 15px 40px; background: #3498db; color: white;" onclick="resetToStart()">Î•Î ÎŸÎœÎ•ÎÎŸÎ£ ÎœÎ‘Î˜Î—Î¤Î—Î£</button>
    </div>

    <div class="level-menu">
        <button id="btn-easy" class="lvl-btn active" onclick="setMode('easy')">Î‘' Î¤Î¬Î¾Î·</button>
        <button id="btn-med" class="lvl-btn" onclick="setMode('med')">Î’' - Î“' Î¤Î¬Î¾Î·</button>
        <button id="btn-hard" class="lvl-btn" onclick="setMode('hard')">Î”' Î¤Î¬Î¾Î·</button>
    </div>

    <div class="game-layout">
        <div class="left-panel">
            <img src="tameio.png" class="cashier-img" onerror="this.src='https://via.placeholder.com/450x400?text=Tameio.png'">
            <div id="msg">Î ÎµÏÎ¹Î¼Î­Î½Ï‰ Ï„Î± ÏÎ­ÏƒÏ„Î±...</div>
        </div>
        <div class="right-panel">
            <div class="info-card">
                <button class="exit-btn" onclick="showEndScreen()">Î¤Î•Î›ÎŸÎ£</button>
                <div id="product-emoji" class="product-display">ğŸ</div>
                <div class="display-screen" id="price-display">0,00 â‚¬</div>
                <div class="banknotes-received">
                    <img src="euro10.png" id="note10" class="note-received" alt="10â‚¬">
                    <img src="euro20.png" id="note20" class="note-received" alt="20â‚¬">
                </div>
                <button class="green-btn" onclick="check()">OK</button>
            </div>
            <div class="drawer" id="drawer"></div>
        </div>
    </div>

    <div class="footer-info">
        <div class="creator-info">Papanikolaou Georgios Â© 2025</div>
        <div>Intra-school Training Professional Development in Mathematics</div>
    </div>
</div>

<audio id="register" src="https://www.soundjay.com/misc/sounds/cash-register-purchase-1.mp3"></audio>
<audio id="clap" src="https://www.soundjay.com/human/sounds/applause-01.mp3"></audio>

<script>
    let mode = 'easy', price = 0, paid = 10, selected = 0, studentName = "", gender = "m";
    const items = ['ğŸ','ğŸ¦','ğŸ§¸','âš½','ğŸ°','ğŸ”','ğŸ','ğŸ«','ğŸ‡','ğŸš²','ğŸ•','ğŸ©'];
    const coinsData = [
        {v:5, i:'euro5.png', type:'bill'},
        {v:2, i:'euro2.png', type:'coin'}, {v:1, i:'euro1.png', type:'coin'},
        {v:0.5, i:'cents50.png', type:'coin'}, {v:0.2, i:'cents20.png', type:'coin'}, {v:0.1, i:'cents10.png', type:'coin'},
        {v:0.05, i:'cents5.png', type:'coin'}, {v:0.02, i:'cents2.png', type:'coin'}, {v:0.01, i:'cents1.png', type:'coin'}
    ];

    function getVocative(name) {
        if (!name) return "";
        name = name.trim();
        let lowerName = name.toLowerCase();
        if (gender === 'm' && (name.endsWith('Ï‚') || name.endsWith('Î£'))) {
            if (lowerName === 'ÎºÏ‰Î½ÏƒÏ„Î±Î½Ï„Î¯Î½Î¿Ï‚' || lowerName === 'ÎºÏ‰ÏƒÏ„Î±Î½Ï„Î¯Î½Î¿Ï‚' || lowerName === 'ÎºÏ‰Î½ÏƒÏ„Î±Î½Ï„Î¹Î½Î¿Ï‚' || lowerName === 'ÎºÏ‰ÏƒÏ„Î±Î½Ï„Î¹Î½Î¿Ï‚') {
                return name.slice(0, -2) + (name.endsWith('Î£') ? 'Î•' : 'Îµ');
            }
            if (lowerName.endsWith('Î¿Ï‚')) {
                return name.slice(0, -2) + (name.endsWith('ÎŸÎ£') ? 'ÎŸ' : 'Î¿');
            }
            return name.slice(0, -1);
        }
        return name;
    }

    function setGender(g) {
        gender = g;
        document.getElementById('boyBtn').style.background = (g === 'm') ? '#3498db' : 'white';
        document.getElementById('boyBtn').style.color = (g === 'm') ? 'white' : 'black';
        document.getElementById('girlBtn').style.background = (g === 'f') ? '#e91e63' : 'white';
        document.getElementById('girlBtn').style.color = (g === 'f') ? 'white' : 'black';
        document.getElementById('finalStartBtn').style.display = 'block';
    }

    function speak(text, callback) {
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance();
        msg.text = text;
        msg.lang = 'el-GR';
        msg.pitch = 1.35; 
        msg.rate = 0.9;
        let voices = window.speechSynthesis.getVoices();
        let female = voices.find(v => v.lang.startsWith('el') && (v.name.includes('Maria') || v.name.includes('Eleni') || v.name.includes('Microsoft Maria')));
        if(female) msg.voice = female;
        if (callback) msg.onend = callback;
        window.speechSynthesis.speak(msg);
    }

    function initGame() {
        let rawName = document.getElementById('studentName').value;
        studentName = getVocative(rawName) || (gender === 'm' ? "Ï†Î¯Î»Îµ Î¼Î¿Ï…" : "Ï†Î¯Î»Î· Î¼Î¿Ï…");
        document.getElementById('startScreen').style.display = 'none';
        let ready = (gender === 'm') ? "Î­Ï„Î¿Î¹Î¼Î¿Ï‚" : "Î­Ï„Î¿Î¹Î¼Î·";
        speak("Î“ÎµÎ¹Î± ÏƒÎ¿Ï… " + studentName + "! Î•Î¯ÏƒÎ±Î¹ " + ready + "; Î Î¬Î¼Îµ Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ!", function() {
            setTimeout(start, 500);
        });
    }

    function showEndScreen() {
        document.getElementById('endScreen').style.display = 'flex';
        let feedback = (gender === 'm') ? "Î‰ÏƒÎ¿Ï…Î½ ÎºÎ±Ï„Î±Ï€Î»Î·ÎºÏ„Î¹ÎºÏŒÏ‚ Î²Î¿Î·Î¸ÏŒÏ‚!" : "Î‰ÏƒÎ¿Ï…Î½ ÎºÎ±Ï„Î±Ï€Î»Î·ÎºÏ„Î¹ÎºÎ® Î²Î¿Î·Î¸ÏŒÏ‚!";
        document.getElementById('byeMsg').innerText = studentName + ", " + feedback;
        speak("ÎœÏ€ÏÎ¬Î²Î¿ " + studentName + "! " + feedback + " Î£Îµ Ï€ÎµÏÎ¹Î¼Î­Î½Ï‰ Î½Î± Î¾Î±Î½Î±Ï€Î±Î¯Î¾Î¿Ï…Î¼Îµ!");
    }

    function resetToStart() {
        document.getElementById('studentName').value = "";
        document.getElementById('finalStartBtn').style.display = 'none';
        document.getElementById('endScreen').style.display = 'none';
        document.getElementById('startScreen').style.display = 'flex';
    }

    function setMode(m) {
        mode = m;
        document.querySelectorAll('.lvl-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + (m==='easy'?'easy':m==='med'?'med':'hard')).classList.add('active');
        start();
    }

    function start() {
        selected = 0;
        document.getElementById('msg').innerText = "Î ÎµÏÎ¹Î¼Î­Î½Ï‰ Ï„Î± ÏÎ­ÏƒÏ„Î±...";
        document.getElementById('product-emoji').innerText = items[Math.floor(Math.random() * items.length)];
        if(mode === 'hard') {
            paid = 20;
            document.getElementById('note20').classList.add('active-note');
            document.getElementById('note10').classList.remove('active-note');
            price = parseFloat((Math.random() * 14 + 1).toFixed(2));
        } else {
            paid = 10;
            document.getElementById('note10').classList.add('active-note');
            document.getElementById('note20').classList.remove('active-note');
            price = mode === 'easy' ? Math.floor(Math.random() * 7) + 1 : parseFloat(((Math.floor(Math.random() * 150) + 10) * 0.05).toFixed(2));
        }
        const priceStr = price.toFixed(2).replace('.', ',');
        document.getElementById('price-display').innerText = priceStr + " â‚¬";
        speak(studentName + ", Ï„Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ ÎºÎ¬Î½ÎµÎ¹ " + priceStr + " ÎµÏ…ÏÏ. ÎœÎ¿Ï… Î­Î´Ï‰ÏƒÎµÏ‚ " + paid + " ÎµÏ…ÏÏ. Î”ÏÏƒÎµ Î¼Î¿Ï… Ï„Î± ÏÎ­ÏƒÏ„Î±.");
        render();
    }

    function render() {
        const d = document.getElementById('drawer');
        d.innerHTML = '';
        coinsData.forEach(c => {
            if(mode === 'easy' && c.v < 1) return;
            if(mode === 'med' && c.v < 0.05) return;
            let count = (c.v === 5) ? 2 : 4;
            for(let i=0; i < count; i++) {
                const div = document.createElement('div');
                div.className = c.type === 'bill' ? 'bill-item' : 'coin-item';
                div.innerHTML = `<img src="${c.i}" onerror="this.style.display='none'"><div class="selection-ring"></div>`;
                div.onclick = function() {
                    this.classList.toggle('selected');
                    selected += this.classList.contains('selected') ? c.v : -c.v;
                };
                d.appendChild(div);
            }
        });
    }

    function check() {
        document.getElementById('register').play();
        const target = parseFloat((paid - price).toFixed(2));
        setTimeout(() => {
            if(Math.abs(selected - target) < 0.009) {
                document.getElementById('msg').innerText = "ğŸ‘ Î£Ï‰ÏƒÏ„Î¬ " + studentName + "! ğŸ‘";
                speak("Î•Ï…Ï‡Î±ÏÎ¹ÏƒÏ„Ï Ï€Î¿Î»Ï " + studentName + ", ÎµÎ¯Î½Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚!");
                document.getElementById('clap').play();
                setTimeout(start, 5000);
            } else {
                document.getElementById('msg').innerText = "âŒ Î›Î¬Î¸Î¿Ï‚ " + studentName + "...";
                speak(studentName + ", Î¾Î±Î½Î±Î¼Î­Ï„ÏÎ·ÏƒÎµ Î»Î¯Î³Î¿ Ï„Î± ÏÎ­ÏƒÏ„Î±.");
            }
        }, 650);
    }
    window.speechSynthesis.onvoiceschanged = () => { window.speechSynthesis.getVoices(); };
</script>
</body>
</html>